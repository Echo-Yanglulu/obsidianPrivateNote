# 源码解析

# virtual dom
1. v-dom是什么
	1. 官方定义：一个编程概念，被保存在内存中的*对UI的映射*，并通过某些库（如React-DOM）渲染为真实的DOM
2. 特性
	1. 一处学习，随处使用。
		1. V-dom提供了对HTML DOM的抽象，所以在web开发中通常不用调用[[DOM]] api
		2. 也是因为它提供了ＤＯＭ的抽象，也可用于开发Native
3. 过程
	1. 在web开发中，v-dom如何渲染为html元素。
		1. 在class组件中可看到，react通过render方法生成v-dom，从而绘制出真实的dom
4. 如何进行diff
	1. 过程
		1. 修改state，调用render方法调用产生一个v-dom
		2. 通过对比新旧v-dom确定需要更新的内容
	2. 层次
		1. 组件级别进行比较
			1. 当一个组件改变时，并不会去检查它们的子组件是否有更新。实际中很大概率是更新的，所以不再牺牲时间进行子组件的比较。直接整个替换
		2. 元素级别比较
			1. 子节点新增、删除：react对元素进行简单的增删
			2. 子节点移动：react会进行比较复杂的比较过程。
				1. 如果开发者把最后一个子节点移动到第一个，react会将前面的节点依次向后移动（如果代码中有这种操作，源码的实现是比较低效的）【日常开发中要避免这种操作】

## dom更新过程
1. 调用dom api更新
	1. 
2. 通过v-dom更新
	1. 每次render生成一个新的v-dom
	2. diff新旧v-dom，确定变更
	3. 调用dom api更新

表面上看起来好像v-dom更新dom的过程多了几步。
频繁操作dom会引起页面重绘