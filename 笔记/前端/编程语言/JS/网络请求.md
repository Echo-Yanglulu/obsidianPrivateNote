# 概述
范围：现代浏览器通过XHR对象原生支持CORS
ajax请求
# XHR对象
## XHR level 2
### [[FormData]]类型
不用手动添加表示模拟表单提交的请求头contentType: xml/app-formurlencoded
### 超时
timeout
### 超时事件
ontimeout
## 进度事件
1. loadstart：收到响应的第一个字节
2. progress：接收响应期间
3. 结果
	1. load：**成功**接收完响应
	2. error：响应**出错**
	3. abort：调用abort()方法**中止** 
4. loadend：通信结束
# 跨源资源共享
背景：XHR的主要限制是跨源安全策略。但浏览器也需要进行合法跨源的能力
CORS：规定了浏览器与服务器如何实现跨源通信
基本思路：通过添加自定义头部让浏览器与服务器互相了解，以确认响应应该成功或失败
## 分类
### 简单请求
（GET或POST）：没有自定义头部，且请求体是text/plain。
		1. 会在发送时额外添加一个Origin头部，包含发送请求的页面的的源。让服务器确认是否为该源的资源提供响应
		2. 如果服务器没有Access-Control-Allow-Origin，或有源但不匹配，则不会响应。否则会响应
### 预检请求
使用自定义头部、非GET/POST的[[请求方法]]，不同请求体内容类型。
		1. 某个涉及以上某个高级选项时，会先发一次送预检请求[^1] 
		2. 预检请求响应
			1. allow origin
			2. allow headers
			3. allow method
			4. max age：预检请求的响应会被缓存
### 凭据请求
默认情况：跨源请求不提供[[凭据]]（cookie, http认证，和客户端[[SSL]]证书）。可通过设置withCredentials为true，以表明**请求会发送凭据**。
如果服务器允许带凭据的请求，可在响应中包含头部allow credentials : true.。
结果：如果凭据请求的响应中没有该头部，则浏览器不会把这个响应交给JS
# 替代性跨源技术
CORS出现之前，实现ajax通信比较麻烦：需要依赖能够执行跨源请求的DOM特性。
虽然CORS已经得到广泛支持，但这些技术仍然可用，因为**不需要修改服务器**。
## 图片探测
## JSONP
# Fetch API

1. 定义了请求、响应、及其连接过程：获取(fetch)
2. 特点：有XHR对象的所有功能，但更容易使用，接口更现代化（接口更现代化是什么意思）
3. 场景
	1. 能在web工作线程等现代web工具中使用
4. 范围：主页面执行线程、工作线程、模块
5. 机制：调用这个方法，浏览器会向指定URL发送请求。
	1. 分派请求
	2. 读取响应
	3. 处理状态码和请求失败
	4. 自定义选项
## 常见fetch请求模式
1. 发送JSON数据

## Headers对象
## Request对象
## Response对象
## Request、Response及Body混入
# Beacon API
# Web Socket
## API
## 发送与接收数据
## 其他事件

# 安全

# 小结
浏览器控制：是否把响应交给JS

[^1]: 一种服务器验证机制：使用OPTIONS方法，包含头部：Origin, Access-Control-Request-Method：请求希望使用的方法。Access-Control-Request-Headers：要使用的自定义头部列表，逗号连接