由于有[[前后端分离]]，所以可从前端与后端两个方面讨论发布策略。
# 前端发布策略
前端发布的本质是[[静态资源]][^1]的发布[^2]。
## 初始状态下的前端资源
1. 存在一个HTML模板
2. HTML中引入了一个CSS，
3. 这两个都由服务器反向代理
![[Pasted image 20220817230244.png]]
网络时序图：页面与CSS会依次加载
这种原始状态的前端加载，如何进行优化？可用[[缓存]]，协商缓存可以，因为还要发送一次请求。本地缓存可以，但本地缓存浏览器要怎么知道**资源已经更新**？
1. 给URL加上版本号[^3]
	1. 不行，因为静态资源可能很多，如果有一个资源发生了变化，就全量修改每个资源的版本号，缓存的意义就不大了[^4]
2. 用[[hash值]]替代版本号
# 后端发布策略

[^1]: 一般是JS与CSS，不包括动态渲染出来的HTML模板。
[^2]: 因为HTML页面本身并没有什么东西？都是JS,CSS,图片等内容？
[^3]: 因为==本地缓存与请求的URL有关==，就在资源的URL后面加上一个版本相关的参数，每次更新资源就同步更新参数。下次更新时修改版本号，让用户的缓存失效。
[^4]: 只有某个资源变化，却全量更新资源的URL，就没有必要缓存了，因为内容没有变化的资源也会被重新请求（只是版本号变了）。