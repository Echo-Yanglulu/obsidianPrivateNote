/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');
var path = require('path');
var require$$0 = require('fs');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var path__default = /*#__PURE__*/_interopDefaultLegacy(path);
var require$$0__default = /*#__PURE__*/_interopDefaultLegacy(require$$0);

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function createCommonjsModule(fn, basedir, module) {
	return module = {
		path: basedir,
		exports: {},
		require: function (path, base) {
			return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
		}
	}, fn(module, module.exports), module.exports;
}

function commonjsRequire () {
	throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
}

/**
 * Simple asynchronous tool for saving my life.
 */

/**
 * A wrapper function create a `Chain` instance at the same 
 * time initializes the `queue` with a serial of arguments. 
 */
var traverseChain = function() {
  var s = new Chain();
  return s.__init.apply(s, arguments);
};


/** 
 * Chain constructor.
 * @api pivate
 */
function Chain() {
  this.queue = [];
  this.onend = function(err) {};
  this.pass = true;
} 


/**
 * Trying to Initialize the `queue` with a serial of arguments. 
 *
 * @api private
 */
Chain.prototype.__init = function() {
  this.queue = [].slice.call(arguments);
  return this;
};


/**
 * Add a `job` or an array of `jobs` into the Chain.
 * A `job` is defined by a function. 
 *
 * @param {Function|Array} a function or an array of functions 
 * @return {Chain}
 * @api public
 */
Chain.prototype.add = function() {
  var jobs = [].slice.call(arguments);
  jobs.forEach(
    (function(job) {
      this.queue.push.apply(
        this.queue, Array.isArray(job) ? job : [job]
      );
    }).bind(this)
  );
  return this;
};


/**
 * The iterator of the Chain. When it reaches end then call 
 * call the callback function.
 * 
 * @return {Chain}
 * @api public
 */
Chain.prototype.next = function() {
  if (!this.pass) return this;
  if (this.queue.length) {
    this.queue.shift().call();    
  } else {
    this.onend();
  }
  return this;
};  


/**
 * Terminate the chain.
 * 
 * @return {Chain}
 * @api public
 */
Chain.prototype.stop = function() {
  this.pass = false;
  this.onend.apply(this, arguments);
  return this;
};  
 

/**
 * Start iterating through the Chain and ends with the  
 * given callback.
 * 
 * @param {Function} end callback
 * @return {Chain} 
 * @api public
 */
Chain.prototype.traverse = function(fn) {
  fn && fn.call && fn.apply && (this.onend = fn);
  this.next();
  return this;
};

var find_1 = createCommonjsModule(function (module) {
var fs = require$$0__default['default'];




/**
 * Outline the APIs.
 */
var find = module.exports = {

  // file:      function([pat,] root, callback) {}
  // dir:       function([pat,] root, callback) {}

  // eachfile:  function([pat,] root, action) {}
  // eachdir:   function([pat,] root, action) {}

  // fileSync:  function([pat,] root) {}
  // dirSync:   function([pat,] root) {}
  // use::      function(options) {}

};


var fss = {};

/**
 *  Error handler wrapper.
 */
fss.errorHandler = function(err) {
  if (err) {
    if (find.__errorHandler) {
      find.__errorHandler(err);
    } else {
      throw err;
    }
  }
};


var error = {
  notExist: function(name) {
    return new Error(name + ' does not exist.');
  }
};


var is = (function() {
  function existed(name) {
    return fs.existsSync(name);
  }
  function fsType(type) {
    return function(name) {
      try {
        return fs.lstatSync(name)['is' + type]();
      } catch(err) {
        if (!/^(EPERM|EACCES)$/.test(err.code)) {
          fss.errorHandler(err);
        }
        else {
          console.warn('Warning: Cannot access %s', name);
        }
      }
    }
  }
  function objType(type) {
    return function(input) {
      if (type === 'Function') {
        return typeof input === 'function';
      }
      return ({}).toString.call(input) === '[object ' + type +  ']';
    }
  }
  return {
    existed:      existed,
    file:         fsType('File'),
    directory:    fsType('Directory'),
    symbolicLink: fsType('SymbolicLink'),

    string:       objType('String'),
    regexp:       objType('RegExp'),
    func:         objType('Function')
  };
}());


/**
 *  Method injection for handling errors.
 */
['readdir', 'lstat'].forEach(function(method) {
  fss[method] = function(path, callback) {
    var origin = fs[method];
    return origin.apply(fs, [path, function(err) {
      fss.errorHandler(err);
      return callback.apply(null, arguments);
    }]);
  };
});


/**
 * Enhancement for fs.readlink && fs.readlinkSync.
 */
fss.readlink = function(name, fn, depth) {
  if (depth == undefined) depth = 5;
  if (!is.existed(name) && (depth < 5)) {
    return fn(path__default['default'].resolve(name));
  }
  var isSymbolicLink = is.symbolicLink(name);
  if (!isSymbolicLink) {
    fn(path__default['default'].resolve(name));
  } else if (depth) {
    fs.realpath(name, function(err, origin) {
      if (err && /^(ENOENT|ELOOP|EPERM|EACCES)$/.test(err.code)) {
        fn(name);
      } else {
        if (err) {
          fss.errorHandler(err);
        } else {
          fss.readlink(origin, fn, --depth);
        }
      }
    });
  } else {
    fn(isSymbolicLink ? '' : path__default['default'].resolve(name));
  }
};

fss.readlinkSync = function(name, depth) {
  if (depth == undefined) depth = 5;
  if (!is.existed(name) && depth < 5) {
    return path__default['default'].resolve(name);
  }
  var isSymbolicLink = is.symbolicLink(name);
  if (!isSymbolicLink) {
    return path__default['default'].resolve(name);
  } else if (depth) {
    var origin;
    try {
      origin = fs.realpathSync(name);
    } catch (err) {
      if (/^(ENOENT|ELOOP|EPERM|EACCES)$/.test(err.code)) {
        return name;
      } else {
        fss.errorHandler(err);
      }
    }
    return fss.readlinkSync(origin, --depth);
  } else {
    return isSymbolicLink ? '' : path__default['default'].resolve(name);
  }
};


/**
 * Check pattern against the path
 */
var compare = function(pat, name) {
  var str = path__default['default'].basename(name);
  return (
       is.regexp(pat) && pat.test(name)
    || is.string(pat) && pat === str
  );
};


/**
 * Traverse a directory recursively and asynchronously.
 *
 * @param {String} root
 * @param {String} type
 * @param {Function} action
 * @param {Function} callback
 * @param {Chain} c
 * @api private
 */
var traverseAsync = function(root, type, action, callback, c) {
  if (!is.existed(root)) {
    fss.errorHandler(error.notExist(root));
  }

  var originRoot = root;
  if (is.symbolicLink(root)) {
    root = fss.readlinkSync(root);
  }

  if (is.directory(root)) {
    fss.readdir(root, function(err, all) {
      var chain = traverseChain();
      all && all.forEach(function(dir) {
        dir = path__default['default'].join(originRoot, dir);
        chain.add(function() {
          var handleFile = function() {
            if (type == 'file') action(dir);
            process.nextTick(function() { chain.next(); });
          };
          var handleDir = function(skip) {
            if (type == 'dir') action(dir);
            if (skip) chain.next();
            else process.nextTick(function() { traverseAsync(dir, type, action, callback, chain);});
          };
          var isSymbolicLink = is.symbolicLink(dir);
          if (is.directory(dir)) {
            handleDir();
          } else if (isSymbolicLink) {
            fss.readlink(dir, function(origin) {
              if (origin) {
                if (is.existed(origin) && is.directory(origin)) {
                  handleDir(isSymbolicLink);
                } else {
                  handleFile();
                }
              } else {
                chain.next();
              }
            });
          } else {
            handleFile();
          }
        });
      });
      chain.traverse(function() {
        c ? c.next() : callback();
      });
    });
  }
};


/**
 * Traverse a directory recursively.
 *
 * @param {String} root
 * @param {String} type
 * @param {Function} action
 * @return {Array} the result
 * @api private
 */
var traverseSync = function(root, type, action) {
  if (!is.existed(root)) throw error.notExist(root);
  var originRoot = root;
  if (is.symbolicLink(root)) {
    root = fss.readlinkSync(root);
  }
  if (is.directory(root)) {
    fs.readdirSync(root).forEach(function(dir) {
      dir = path__default['default'].join(originRoot, dir);
      var handleDir = function(skip) {
        if (type == 'dir') action(dir);
        if (skip) return;
        traverseSync(dir, type, action);
      };
      var handleFile = function() {
        if (type == 'file') action(dir);
      };
      var isSymbolicLink = is.symbolicLink(dir);
      if (is.directory(dir)) {
        handleDir();
      } else if (isSymbolicLink) {
        var origin = fss.readlinkSync(dir);
        if (origin) {
          if (is.existed(origin) && is.directory(origin)) {
            handleDir(isSymbolicLink);
          } else {
            handleFile();
          }
        }
      } else {
        handleFile();
      }
    });
  }
};


['file', 'dir'].forEach(function(type) {

  /**
   * `find.file` and `find.dir`
   *
   * Find files or sub-directories in a given directory and
   * passes the result in an array as a whole. This follows
   * the default callback style of nodejs, think about `fs.readdir`,
   *
   * @param {RegExp|String} pat
   * @param {String} root
   * @param {Function} fn
   * @api public
   */
  find[type] = function(pat, root, fn) {
    var buffer = [];
    if (arguments.length == 2) {
      fn = root;
      root = pat;
      pat = '';
    }
    process.nextTick(function() {
      traverseAsync(
        root
      , type
      , function(n) { buffer.push(n);}
      , function() {
          if (is.func(fn) && pat) {
            fn(buffer.filter(function(n) {
              return compare(pat, n);
            }));
          } else {
            fn(buffer);
          }
        }
      );
    });
    return {
      error: function(handler) {
        if (is.func(handler)) {
          find.__errorHandler = handler;
        }
      }
    }
  };

  /**
   * `find.eachfile` and `find.eachdir`
   *
   * Find files or sub-directories in a given directory and
   * apply with a given action to each result immediately
   * rather than pass them back as an array.
   *
   * @param {RegExp|String} pat
   * @param {String} root
   * @param {Function} action
   * @return {Object} for chain methods
   * @api public
   *
   */
  find['each' + type] = function(pat, root, action) {
    var callback = function() {};
    if (arguments.length == 2) {
      action = root;
      root = pat;
      pat = '';
    }
    process.nextTick(function() {
      traverseAsync(
          root
        , type
        , function(n) {
            if (!is.func(action)) return;
            if (!pat || compare(pat, n)) {
              action(n);
            }
          }
        , callback
      );
    });
    return {
      end: function(fn) {
        if (is.func(fn)) {
          callback = fn;
        }
        return this;
      },
      error: function(handler) {
        if (is.func(handler)) {
          find.__errorHandler = handler;
        }
        return this;
      }
    };
  };

  /**
   * `find.fileSync` and `find.dirSync`
   *
   * Find files or sub-directories in a given directory synchronously
   * and returns the result as an array. This follows the default 'Sync'
   * methods of nodejs, think about `fs.readdirSync`,
   *
   * @param {RegExp|String} pat
   * @param {String} root
   * @return {Array} the result
   * @api public
   */
  find[type + 'Sync'] = function(pat, root) {
    var buffer = [];
    if (arguments.length == 1) {
      root = pat;
      pat = '';
    }
    traverseSync(root, type, function(n) {
      buffer.push(n);
    });
    return pat && buffer.filter(function(n) {
      return compare(pat, n);
    }) || buffer;
  };

});


var fsMethods = [
  'existsSync',
  'lstatSync',
  'realpath',
  'realpathSync',
  'readdir',
  'readdirSync'
];


/**
 * Configuations for internal usage
 *
 * @param {Object} options
 * @api public
 */
find.use = function(options) {
  if (options && options.fs) {
    if (fsMethods.every(n => !!options.fs[n])) {
      fs = options.fs;
    } else {
      throw new Error('The provided fs object is not compatiable with native fs.');
    }
  }
  return find;
};
});

const hashRegex = /#([a-zA-Z-_]+?)(:)(-?[\d.]+(?:e-?\d+)?)?/;
const actionName = 'open-to-line';
class ImdonePlugin extends obsidian.Plugin {
    constructor(app, pluginManifest) {
        super(app, pluginManifest);
        this.app = app;
        this.workspace = app.workspace;
        this.adapter = app.vault.adapter;
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('loading imdone plugin');
            this.imdonePaths = yield this.getImdoneProjectPaths();
            this.inImdoneProject = yield this.isVaultInImdoneProject();
            this.registerMarkdownPostProcessor((el, ctx) => this.markdownPostProcessor(el, ctx));
            this.registerObsidianProtocolHandler(actionName, (params) => {
                if (params.action == actionName && params.file) {
                    const file = params.file.substring(1).replace(/\\/g, '/');
                    this.workspace.openLinkText(file, '', false, { state: { mode: 'source' } }).then(() => {
                        const cmEditor = this.getEditor();
                        if (!cmEditor)
                            return;
                        if (params.line) {
                            cmEditor.setCursor(parseInt(params.line, 10), 0);
                            cmEditor.scrollIntoView(null, 200);
                        }
                        cmEditor.focus();
                    });
                }
            });
        });
    }
    onunload() {
        console.log('unloading imdone plugin');
    }
    getEditor() {
        const markdownView = this.workspace.getActiveViewOfType(obsidian.MarkdownView);
        if (!markdownView)
            return;
        const cmEditor = markdownView.sourceMode.cmEditor;
        return cmEditor;
    }
    markdownPostProcessor(el, ctx) {
        return __awaiter(this, void 0, void 0, function* () {
            const sourceFilePath = path.join(this.getVaultPath(), ctx.sourcePath);
            if (this.isFileInImdoneProject(sourceFilePath)) {
                this.updateCardLinksHref(el);
                this.makeCardHashtagsLinks(el);
            }
        });
    }
    isImdoneCardLink(el) {
        return el && hashRegex.test(el.hash);
    }
    getImdoneCardLinks(el) {
        const links = Array.from(el.querySelectorAll('.external-link'));
        return links.filter(el => this.isImdoneCardLink(el));
    }
    updateCardLinksHref(el) {
        const links = this.getImdoneCardLinks(el);
        links.forEach((link) => {
            const { text, hash } = link;
            link.href = this.getImdoneURL(text, hash, 'MARKDOWN');
        });
    }
    isImdoneCardHashtag(el) {
        return hashRegex.test(el.parentElement.getText());
    }
    getImdoneCardHashtags(el) {
        const links = Array.from(el.querySelectorAll('a.tag[href^="#"]'));
        return links.filter(el => this.isImdoneCardHashtag(el));
    }
    makeCardHashtagsLinks(el) {
        this.getImdoneCardHashtags(el).forEach(el => {
            const parent = el.parentElement;
            const tag = el.innerText;
            const text = parent.getText();
            const hash = text.match(hashRegex)[0];
            parent.childNodes.forEach(node => {
                if (node.nodeName === '#text')
                    node.textContent = '';
            });
            const imdoneLink = document.createElement('a');
            const imdoneLinkText = text.replace(hash, '');
            imdoneLink.setText(text.replace(tag, ''));
            imdoneLink.href = this.getImdoneURL(imdoneLinkText, hash, 'HASHTAG');
            imdoneLink.addClass('external-link');
            parent.append(imdoneLink);
        });
    }
    getImdoneURL(text, hash, type) {
        const path = this.getActiveFilePath().replace(/\\/g, '/');
        return `imdone://${encodeURI(path)}?text=${encodeURIComponent(text.trim())}&hash=${encodeURIComponent(hash)}&type=${type}`;
    }
    getActiveFilePath() {
        const path = this.workspace.getActiveFile().path;
        return this.adapter.getFullPath(path);
    }
    getActiveFileDir() {
        return path.join(this.getVaultPath(), path.dirname(this.workspace.getActiveFile().path));
    }
    getVaultPath() {
        return this.adapter.getBasePath();
    }
    isVaultInImdoneProject() {
        return __awaiter(this, void 0, void 0, function* () {
            let cwd = this.getVaultPath();
            while (true) {
                const imdonePath = path.join(cwd, '.imdone');
                if (yield this.exists(imdonePath))
                    return !!imdonePath;
                const dirNames = cwd.split(path.sep);
                dirNames.pop();
                cwd = dirNames.join(path.sep);
                if (cwd === '')
                    return;
            }
        });
    }
    isFileInImdoneProject(file) {
        return this.inImdoneProject || this.imdonePaths.find(_path => {
            return file.startsWith(_path);
        });
    }
    getImdoneProjectPaths() {
        return __awaiter(this, void 0, void 0, function* () {
            const cwd = this.getVaultPath();
            return new Promise((resolve, reject) => {
                find_1.dir(/\.imdone$/, cwd, dirs => {
                    resolve(dirs.map(dir => dir.replace(/\.imdone$/, '')));
                }).error(reject);
            });
        });
    }
    exists(_path) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const stats = yield require$$0.promises.stat(_path);
                return stats && stats.isDirectory();
            }
            catch (_a) {
                return false;
            }
        });
    }
}

module.exports = ImdonePlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5vZGVfbW9kdWxlcy90cmF2ZXJzZS1jaGFpbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9maW5kL2luZGV4LmpzIiwibWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSkge1xyXG4gICAgZm9yICh2YXIgaSA9IDAsIGlsID0gZnJvbS5sZW5ndGgsIGogPSB0by5sZW5ndGg7IGkgPCBpbDsgaSsrLCBqKyspXHJcbiAgICAgICAgdG9bal0gPSBmcm9tW2ldO1xyXG4gICAgcmV0dXJuIHRvO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XHJcbn0pIDogZnVuY3Rpb24obywgdikge1xyXG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XHJcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBwcml2YXRlTWFwKSB7XHJcbiAgICBpZiAoIXByaXZhdGVNYXAuaGFzKHJlY2VpdmVyKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gZ2V0IHByaXZhdGUgZmllbGQgb24gbm9uLWluc3RhbmNlXCIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHByaXZhdGVNYXAuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHByaXZhdGVNYXAsIHZhbHVlKSB7XHJcbiAgICBpZiAoIXByaXZhdGVNYXAuaGFzKHJlY2VpdmVyKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gc2V0IHByaXZhdGUgZmllbGQgb24gbm9uLWluc3RhbmNlXCIpO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZU1hcC5zZXQocmVjZWl2ZXIsIHZhbHVlKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG4iLCIvKipcbiAqIFNpbXBsZSBhc3luY2hyb25vdXMgdG9vbCBmb3Igc2F2aW5nIG15IGxpZmUuXG4gKi9cblxuLyoqXG4gKiBBIHdyYXBwZXIgZnVuY3Rpb24gY3JlYXRlIGEgYENoYWluYCBpbnN0YW5jZSBhdCB0aGUgc2FtZSBcbiAqIHRpbWUgaW5pdGlhbGl6ZXMgdGhlIGBxdWV1ZWAgd2l0aCBhIHNlcmlhbCBvZiBhcmd1bWVudHMuIFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcyA9IG5ldyBDaGFpbigpO1xuICByZXR1cm4gcy5fX2luaXQuYXBwbHkocywgYXJndW1lbnRzKTtcbn1cblxuXG4vKiogXG4gKiBDaGFpbiBjb25zdHJ1Y3Rvci5cbiAqIEBhcGkgcGl2YXRlXG4gKi9cbmZ1bmN0aW9uIENoYWluKCkge1xuICB0aGlzLnF1ZXVlID0gW107XG4gIHRoaXMub25lbmQgPSBmdW5jdGlvbihlcnIpIHt9O1xuICB0aGlzLnBhc3MgPSB0cnVlO1xufSBcblxuXG4vKipcbiAqIFRyeWluZyB0byBJbml0aWFsaXplIHRoZSBgcXVldWVgIHdpdGggYSBzZXJpYWwgb2YgYXJndW1lbnRzLiBcbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuQ2hhaW4ucHJvdG90eXBlLl9faW5pdCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnF1ZXVlID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICByZXR1cm4gdGhpcztcbn1cblxuXG4vKipcbiAqIEFkZCBhIGBqb2JgIG9yIGFuIGFycmF5IG9mIGBqb2JzYCBpbnRvIHRoZSBDaGFpbi5cbiAqIEEgYGpvYmAgaXMgZGVmaW5lZCBieSBhIGZ1bmN0aW9uLiBcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufEFycmF5fSBhIGZ1bmN0aW9uIG9yIGFuIGFycmF5IG9mIGZ1bmN0aW9ucyBcbiAqIEByZXR1cm4ge0NoYWlufVxuICogQGFwaSBwdWJsaWNcbiAqL1xuQ2hhaW4ucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgam9icyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgam9icy5mb3JFYWNoKFxuICAgIChmdW5jdGlvbihqb2IpIHtcbiAgICAgIHRoaXMucXVldWUucHVzaC5hcHBseShcbiAgICAgICAgdGhpcy5xdWV1ZSwgQXJyYXkuaXNBcnJheShqb2IpID8gam9iIDogW2pvYl1cbiAgICAgICk7XG4gICAgfSkuYmluZCh0aGlzKVxuICApO1xuICByZXR1cm4gdGhpcztcbn1cblxuXG4vKipcbiAqIFRoZSBpdGVyYXRvciBvZiB0aGUgQ2hhaW4uIFdoZW4gaXQgcmVhY2hlcyBlbmQgdGhlbiBjYWxsIFxuICogY2FsbCB0aGUgY2FsbGJhY2sgZnVuY3Rpb24uXG4gKiBcbiAqIEByZXR1cm4ge0NoYWlufVxuICogQGFwaSBwdWJsaWNcbiAqL1xuQ2hhaW4ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCF0aGlzLnBhc3MpIHJldHVybiB0aGlzO1xuICBpZiAodGhpcy5xdWV1ZS5sZW5ndGgpIHtcbiAgICB0aGlzLnF1ZXVlLnNoaWZ0KCkuY2FsbCgpOyAgICBcbiAgfSBlbHNlIHtcbiAgICB0aGlzLm9uZW5kKCk7XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59ICBcblxuXG4vKipcbiAqIFRlcm1pbmF0ZSB0aGUgY2hhaW4uXG4gKiBcbiAqIEByZXR1cm4ge0NoYWlufVxuICogQGFwaSBwdWJsaWNcbiAqL1xuQ2hhaW4ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wYXNzID0gZmFsc2U7XG4gIHRoaXMub25lbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgcmV0dXJuIHRoaXM7XG59ICBcbiBcblxuLyoqXG4gKiBTdGFydCBpdGVyYXRpbmcgdGhyb3VnaCB0aGUgQ2hhaW4gYW5kIGVuZHMgd2l0aCB0aGUgIFxuICogZ2l2ZW4gY2FsbGJhY2suXG4gKiBcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGVuZCBjYWxsYmFja1xuICogQHJldHVybiB7Q2hhaW59IFxuICogQGFwaSBwdWJsaWNcbiAqL1xuQ2hhaW4ucHJvdG90eXBlLnRyYXZlcnNlID0gZnVuY3Rpb24oZm4pIHtcbiAgZm4gJiYgZm4uY2FsbCAmJiBmbi5hcHBseSAmJiAodGhpcy5vbmVuZCA9IGZuKTtcbiAgdGhpcy5uZXh0KCk7XG4gIHJldHVybiB0aGlzO1xufVxuXG4iLCJ2YXIgZnMgPSByZXF1aXJlKCdmcycpO1xudmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG52YXIgQ2hhaW4gPSByZXF1aXJlKCd0cmF2ZXJzZS1jaGFpbicpO1xuXG5cbi8qKlxuICogT3V0bGluZSB0aGUgQVBJcy5cbiAqL1xudmFyIGZpbmQgPSBtb2R1bGUuZXhwb3J0cyA9IHtcblxuICAvLyBmaWxlOiAgICAgIGZ1bmN0aW9uKFtwYXQsXSByb290LCBjYWxsYmFjaykge31cbiAgLy8gZGlyOiAgICAgICBmdW5jdGlvbihbcGF0LF0gcm9vdCwgY2FsbGJhY2spIHt9XG5cbiAgLy8gZWFjaGZpbGU6ICBmdW5jdGlvbihbcGF0LF0gcm9vdCwgYWN0aW9uKSB7fVxuICAvLyBlYWNoZGlyOiAgIGZ1bmN0aW9uKFtwYXQsXSByb290LCBhY3Rpb24pIHt9XG5cbiAgLy8gZmlsZVN5bmM6ICBmdW5jdGlvbihbcGF0LF0gcm9vdCkge31cbiAgLy8gZGlyU3luYzogICBmdW5jdGlvbihbcGF0LF0gcm9vdCkge31cbiAgLy8gdXNlOjogICAgICBmdW5jdGlvbihvcHRpb25zKSB7fVxuXG59O1xuXG5cbnZhciBmc3MgPSB7fTtcblxuLyoqXG4gKiAgRXJyb3IgaGFuZGxlciB3cmFwcGVyLlxuICovXG5mc3MuZXJyb3JIYW5kbGVyID0gZnVuY3Rpb24oZXJyKSB7XG4gIGlmIChlcnIpIHtcbiAgICBpZiAoZmluZC5fX2Vycm9ySGFuZGxlcikge1xuICAgICAgZmluZC5fX2Vycm9ySGFuZGxlcihlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9XG59O1xuXG5cbnZhciBlcnJvciA9IHtcbiAgbm90RXhpc3Q6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICByZXR1cm4gbmV3IEVycm9yKG5hbWUgKyAnIGRvZXMgbm90IGV4aXN0LicpO1xuICB9XG59O1xuXG5cbnZhciBpcyA9IChmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gZXhpc3RlZChuYW1lKSB7XG4gICAgcmV0dXJuIGZzLmV4aXN0c1N5bmMobmFtZSk7XG4gIH1cbiAgZnVuY3Rpb24gZnNUeXBlKHR5cGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGZzLmxzdGF0U3luYyhuYW1lKVsnaXMnICsgdHlwZV0oKTtcbiAgICAgIH0gY2F0Y2goZXJyKSB7XG4gICAgICAgIGlmICghL14oRVBFUk18RUFDQ0VTKSQvLnRlc3QoZXJyLmNvZGUpKSB7XG4gICAgICAgICAgZnNzLmVycm9ySGFuZGxlcihlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybignV2FybmluZzogQ2Fubm90IGFjY2VzcyAlcycsIG5hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIG9ialR5cGUodHlwZSkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgaWYgKHR5cGUgPT09ICdGdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBpbnB1dCA9PT0gJ2Z1bmN0aW9uJztcbiAgICAgIH1cbiAgICAgIHJldHVybiAoe30pLnRvU3RyaW5nLmNhbGwoaW5wdXQpID09PSAnW29iamVjdCAnICsgdHlwZSArICAnXSc7XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgZXhpc3RlZDogICAgICBleGlzdGVkLFxuICAgIGZpbGU6ICAgICAgICAgZnNUeXBlKCdGaWxlJyksXG4gICAgZGlyZWN0b3J5OiAgICBmc1R5cGUoJ0RpcmVjdG9yeScpLFxuICAgIHN5bWJvbGljTGluazogZnNUeXBlKCdTeW1ib2xpY0xpbmsnKSxcblxuICAgIHN0cmluZzogICAgICAgb2JqVHlwZSgnU3RyaW5nJyksXG4gICAgcmVnZXhwOiAgICAgICBvYmpUeXBlKCdSZWdFeHAnKSxcbiAgICBmdW5jOiAgICAgICAgIG9ialR5cGUoJ0Z1bmN0aW9uJylcbiAgfTtcbn0oKSk7XG5cblxuLyoqXG4gKiAgTWV0aG9kIGluamVjdGlvbiBmb3IgaGFuZGxpbmcgZXJyb3JzLlxuICovXG5bJ3JlYWRkaXInLCAnbHN0YXQnXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICBmc3NbbWV0aG9kXSA9IGZ1bmN0aW9uKHBhdGgsIGNhbGxiYWNrKSB7XG4gICAgdmFyIG9yaWdpbiA9IGZzW21ldGhvZF07XG4gICAgcmV0dXJuIG9yaWdpbi5hcHBseShmcywgW3BhdGgsIGZ1bmN0aW9uKGVycikge1xuICAgICAgZnNzLmVycm9ySGFuZGxlcihlcnIpO1xuICAgICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgfV0pO1xuICB9XG59KTtcblxuXG4vKipcbiAqIEVuaGFuY2VtZW50IGZvciBmcy5yZWFkbGluayAmJiBmcy5yZWFkbGlua1N5bmMuXG4gKi9cbmZzcy5yZWFkbGluayA9IGZ1bmN0aW9uKG5hbWUsIGZuLCBkZXB0aCkge1xuICBpZiAoZGVwdGggPT0gdW5kZWZpbmVkKSBkZXB0aCA9IDU7XG4gIGlmICghaXMuZXhpc3RlZChuYW1lKSAmJiAoZGVwdGggPCA1KSkge1xuICAgIHJldHVybiBmbihwYXRoLnJlc29sdmUobmFtZSkpO1xuICB9XG4gIHZhciBpc1N5bWJvbGljTGluayA9IGlzLnN5bWJvbGljTGluayhuYW1lKTtcbiAgaWYgKCFpc1N5bWJvbGljTGluaykge1xuICAgIGZuKHBhdGgucmVzb2x2ZShuYW1lKSk7XG4gIH0gZWxzZSBpZiAoZGVwdGgpIHtcbiAgICBmcy5yZWFscGF0aChuYW1lLCBmdW5jdGlvbihlcnIsIG9yaWdpbikge1xuICAgICAgaWYgKGVyciAmJiAvXihFTk9FTlR8RUxPT1B8RVBFUk18RUFDQ0VTKSQvLnRlc3QoZXJyLmNvZGUpKSB7XG4gICAgICAgIGZuKG5hbWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGZzcy5lcnJvckhhbmRsZXIoZXJyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmc3MucmVhZGxpbmsob3JpZ2luLCBmbiwgLS1kZXB0aCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBmbihpc1N5bWJvbGljTGluayA/ICcnIDogcGF0aC5yZXNvbHZlKG5hbWUpKTtcbiAgfVxufVxuXG5mc3MucmVhZGxpbmtTeW5jID0gZnVuY3Rpb24obmFtZSwgZGVwdGgpIHtcbiAgaWYgKGRlcHRoID09IHVuZGVmaW5lZCkgZGVwdGggPSA1O1xuICBpZiAoIWlzLmV4aXN0ZWQobmFtZSkgJiYgZGVwdGggPCA1KSB7XG4gICAgcmV0dXJuIHBhdGgucmVzb2x2ZShuYW1lKTtcbiAgfVxuICB2YXIgaXNTeW1ib2xpY0xpbmsgPSBpcy5zeW1ib2xpY0xpbmsobmFtZSk7XG4gIGlmICghaXNTeW1ib2xpY0xpbmspIHtcbiAgICByZXR1cm4gcGF0aC5yZXNvbHZlKG5hbWUpO1xuICB9IGVsc2UgaWYgKGRlcHRoKSB7XG4gICAgdmFyIG9yaWdpbjtcbiAgICB0cnkge1xuICAgICAgb3JpZ2luID0gZnMucmVhbHBhdGhTeW5jKG5hbWUpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKC9eKEVOT0VOVHxFTE9PUHxFUEVSTXxFQUNDRVMpJC8udGVzdChlcnIuY29kZSkpIHtcbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmc3MuZXJyb3JIYW5kbGVyKGVycik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmc3MucmVhZGxpbmtTeW5jKG9yaWdpbiwgLS1kZXB0aCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGlzU3ltYm9saWNMaW5rID8gJycgOiBwYXRoLnJlc29sdmUobmFtZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIENoZWNrIHBhdHRlcm4gYWdhaW5zdCB0aGUgcGF0aFxuICovXG52YXIgY29tcGFyZSA9IGZ1bmN0aW9uKHBhdCwgbmFtZSkge1xuICB2YXIgc3RyID0gcGF0aC5iYXNlbmFtZShuYW1lKTtcbiAgcmV0dXJuIChcbiAgICAgICBpcy5yZWdleHAocGF0KSAmJiBwYXQudGVzdChuYW1lKVxuICAgIHx8IGlzLnN0cmluZyhwYXQpICYmIHBhdCA9PT0gc3RyXG4gICk7XG59O1xuXG5cbi8qKlxuICogVHJhdmVyc2UgYSBkaXJlY3RvcnkgcmVjdXJzaXZlbHkgYW5kIGFzeW5jaHJvbm91c2x5LlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSByb290XG4gKiBAcGFyYW0ge1N0cmluZ30gdHlwZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICogQHBhcmFtIHtDaGFpbn0gY1xuICogQGFwaSBwcml2YXRlXG4gKi9cbnZhciB0cmF2ZXJzZUFzeW5jID0gZnVuY3Rpb24ocm9vdCwgdHlwZSwgYWN0aW9uLCBjYWxsYmFjaywgYykge1xuICBpZiAoIWlzLmV4aXN0ZWQocm9vdCkpIHtcbiAgICBmc3MuZXJyb3JIYW5kbGVyKGVycm9yLm5vdEV4aXN0KHJvb3QpKVxuICB9XG5cbiAgdmFyIG9yaWdpblJvb3QgPSByb290O1xuICBpZiAoaXMuc3ltYm9saWNMaW5rKHJvb3QpKSB7XG4gICAgcm9vdCA9IGZzcy5yZWFkbGlua1N5bmMocm9vdCk7XG4gIH1cblxuICBpZiAoaXMuZGlyZWN0b3J5KHJvb3QpKSB7XG4gICAgZnNzLnJlYWRkaXIocm9vdCwgZnVuY3Rpb24oZXJyLCBhbGwpIHtcbiAgICAgIHZhciBjaGFpbiA9IENoYWluKCk7XG4gICAgICBhbGwgJiYgYWxsLmZvckVhY2goZnVuY3Rpb24oZGlyKSB7XG4gICAgICAgIGRpciA9IHBhdGguam9pbihvcmlnaW5Sb290LCBkaXIpO1xuICAgICAgICBjaGFpbi5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGhhbmRsZUZpbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0eXBlID09ICdmaWxlJykgYWN0aW9uKGRpcik7XG4gICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uKCkgeyBjaGFpbi5uZXh0KCkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBoYW5kbGVEaXIgPSBmdW5jdGlvbihza2lwKSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PSAnZGlyJykgYWN0aW9uKGRpcik7XG4gICAgICAgICAgICBpZiAoc2tpcCkgY2hhaW4ubmV4dCgpO1xuICAgICAgICAgICAgZWxzZSBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uKCkgeyB0cmF2ZXJzZUFzeW5jKGRpciwgdHlwZSwgYWN0aW9uLCBjYWxsYmFjaywgY2hhaW4pfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBpc1N5bWJvbGljTGluayA9IGlzLnN5bWJvbGljTGluayhkaXIpO1xuICAgICAgICAgIGlmIChpcy5kaXJlY3RvcnkoZGlyKSkge1xuICAgICAgICAgICAgaGFuZGxlRGlyKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc1N5bWJvbGljTGluaykge1xuICAgICAgICAgICAgZnNzLnJlYWRsaW5rKGRpciwgZnVuY3Rpb24ob3JpZ2luKSB7XG4gICAgICAgICAgICAgIGlmIChvcmlnaW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoaXMuZXhpc3RlZChvcmlnaW4pICYmIGlzLmRpcmVjdG9yeShvcmlnaW4pKSB7XG4gICAgICAgICAgICAgICAgICBoYW5kbGVEaXIoaXNTeW1ib2xpY0xpbmspXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGhhbmRsZUZpbGUoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFpbi5uZXh0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBoYW5kbGVGaWxlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSk7XG4gICAgICBjaGFpbi50cmF2ZXJzZShmdW5jdGlvbigpIHtcbiAgICAgICAgYyA/IGMubmV4dCgpIDogY2FsbGJhY2soKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cblxuLyoqXG4gKiBUcmF2ZXJzZSBhIGRpcmVjdG9yeSByZWN1cnNpdmVseS5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vdFxuICogQHBhcmFtIHtTdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvblxuICogQHJldHVybiB7QXJyYXl9IHRoZSByZXN1bHRcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG52YXIgdHJhdmVyc2VTeW5jID0gZnVuY3Rpb24ocm9vdCwgdHlwZSwgYWN0aW9uKSB7XG4gIGlmICghaXMuZXhpc3RlZChyb290KSkgdGhyb3cgZXJyb3Iubm90RXhpc3Qocm9vdCk7XG4gIHZhciBvcmlnaW5Sb290ID0gcm9vdDtcbiAgaWYgKGlzLnN5bWJvbGljTGluayhyb290KSkge1xuICAgIHJvb3QgPSBmc3MucmVhZGxpbmtTeW5jKHJvb3QpO1xuICB9XG4gIGlmIChpcy5kaXJlY3Rvcnkocm9vdCkpIHtcbiAgICBmcy5yZWFkZGlyU3luYyhyb290KS5mb3JFYWNoKGZ1bmN0aW9uKGRpcikge1xuICAgICAgZGlyID0gcGF0aC5qb2luKG9yaWdpblJvb3QsIGRpcik7XG4gICAgICB2YXIgaGFuZGxlRGlyID0gZnVuY3Rpb24oc2tpcCkge1xuICAgICAgICBpZiAodHlwZSA9PSAnZGlyJykgYWN0aW9uKGRpcik7XG4gICAgICAgIGlmIChza2lwKSByZXR1cm47XG4gICAgICAgIHRyYXZlcnNlU3luYyhkaXIsIHR5cGUsIGFjdGlvbik7XG4gICAgICB9XG4gICAgICB2YXIgaGFuZGxlRmlsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodHlwZSA9PSAnZmlsZScpIGFjdGlvbihkaXIpO1xuICAgICAgfVxuICAgICAgdmFyIGlzU3ltYm9saWNMaW5rID0gaXMuc3ltYm9saWNMaW5rKGRpcik7XG4gICAgICBpZiAoaXMuZGlyZWN0b3J5KGRpcikpIHtcbiAgICAgICAgaGFuZGxlRGlyKCk7XG4gICAgICB9IGVsc2UgaWYgKGlzU3ltYm9saWNMaW5rKSB7XG4gICAgICAgIHZhciBvcmlnaW4gPSBmc3MucmVhZGxpbmtTeW5jKGRpcik7XG4gICAgICAgIGlmIChvcmlnaW4pIHtcbiAgICAgICAgICBpZiAoaXMuZXhpc3RlZChvcmlnaW4pICYmIGlzLmRpcmVjdG9yeShvcmlnaW4pKSB7XG4gICAgICAgICAgICBoYW5kbGVEaXIoaXNTeW1ib2xpY0xpbmspO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBoYW5kbGVGaWxlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoYW5kbGVGaWxlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn07XG5cblxuWydmaWxlJywgJ2RpciddLmZvckVhY2goZnVuY3Rpb24odHlwZSkge1xuXG4gIC8qKlxuICAgKiBgZmluZC5maWxlYCBhbmQgYGZpbmQuZGlyYFxuICAgKlxuICAgKiBGaW5kIGZpbGVzIG9yIHN1Yi1kaXJlY3RvcmllcyBpbiBhIGdpdmVuIGRpcmVjdG9yeSBhbmRcbiAgICogcGFzc2VzIHRoZSByZXN1bHQgaW4gYW4gYXJyYXkgYXMgYSB3aG9sZS4gVGhpcyBmb2xsb3dzXG4gICAqIHRoZSBkZWZhdWx0IGNhbGxiYWNrIHN0eWxlIG9mIG5vZGVqcywgdGhpbmsgYWJvdXQgYGZzLnJlYWRkaXJgLFxuICAgKlxuICAgKiBAcGFyYW0ge1JlZ0V4cHxTdHJpbmd9IHBhdFxuICAgKiBAcGFyYW0ge1N0cmluZ30gcm9vdFxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cbiAgZmluZFt0eXBlXSA9IGZ1bmN0aW9uKHBhdCwgcm9vdCwgZm4pIHtcbiAgICB2YXIgYnVmZmVyID0gW107XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikge1xuICAgICAgZm4gPSByb290O1xuICAgICAgcm9vdCA9IHBhdDtcbiAgICAgIHBhdCA9ICcnO1xuICAgIH1cbiAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgdHJhdmVyc2VBc3luYyhcbiAgICAgICAgcm9vdFxuICAgICAgLCB0eXBlXG4gICAgICAsIGZ1bmN0aW9uKG4pIHsgYnVmZmVyLnB1c2gobik7fVxuICAgICAgLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoaXMuZnVuYyhmbikgJiYgcGF0KSB7XG4gICAgICAgICAgICBmbihidWZmZXIuZmlsdGVyKGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmUocGF0LCBuKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm4oYnVmZmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgIGlmIChpcy5mdW5jKGhhbmRsZXIpKSB7XG4gICAgICAgICAgZmluZC5fX2Vycm9ySGFuZGxlciA9IGhhbmRsZXI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogYGZpbmQuZWFjaGZpbGVgIGFuZCBgZmluZC5lYWNoZGlyYFxuICAgKlxuICAgKiBGaW5kIGZpbGVzIG9yIHN1Yi1kaXJlY3RvcmllcyBpbiBhIGdpdmVuIGRpcmVjdG9yeSBhbmRcbiAgICogYXBwbHkgd2l0aCBhIGdpdmVuIGFjdGlvbiB0byBlYWNoIHJlc3VsdCBpbW1lZGlhdGVseVxuICAgKiByYXRoZXIgdGhhbiBwYXNzIHRoZW0gYmFjayBhcyBhbiBhcnJheS5cbiAgICpcbiAgICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBwYXRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHJvb3RcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uXG4gICAqIEByZXR1cm4ge09iamVjdH0gZm9yIGNoYWluIG1ldGhvZHNcbiAgICogQGFwaSBwdWJsaWNcbiAgICpcbiAgICovXG4gIGZpbmRbJ2VhY2gnICsgdHlwZV0gPSBmdW5jdGlvbihwYXQsIHJvb3QsIGFjdGlvbikge1xuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKCkge31cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7XG4gICAgICBhY3Rpb24gPSByb290O1xuICAgICAgcm9vdCA9IHBhdDtcbiAgICAgIHBhdCA9ICcnO1xuICAgIH1cbiAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgdHJhdmVyc2VBc3luYyhcbiAgICAgICAgICByb290XG4gICAgICAgICwgdHlwZVxuICAgICAgICAsIGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgICAgIGlmICghaXMuZnVuYyhhY3Rpb24pKSByZXR1cm47XG4gICAgICAgICAgICBpZiAoIXBhdCB8fCBjb21wYXJlKHBhdCwgbikpIHtcbiAgICAgICAgICAgICAgYWN0aW9uKG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgLCBjYWxsYmFja1xuICAgICAgKTtcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgZW5kOiBmdW5jdGlvbihmbikge1xuICAgICAgICBpZiAoaXMuZnVuYyhmbikpIHtcbiAgICAgICAgICBjYWxsYmFjayA9IGZuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgIGlmIChpcy5mdW5jKGhhbmRsZXIpKSB7XG4gICAgICAgICAgZmluZC5fX2Vycm9ySGFuZGxlciA9IGhhbmRsZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBgZmluZC5maWxlU3luY2AgYW5kIGBmaW5kLmRpclN5bmNgXG4gICAqXG4gICAqIEZpbmQgZmlsZXMgb3Igc3ViLWRpcmVjdG9yaWVzIGluIGEgZ2l2ZW4gZGlyZWN0b3J5IHN5bmNocm9ub3VzbHlcbiAgICogYW5kIHJldHVybnMgdGhlIHJlc3VsdCBhcyBhbiBhcnJheS4gVGhpcyBmb2xsb3dzIHRoZSBkZWZhdWx0ICdTeW5jJ1xuICAgKiBtZXRob2RzIG9mIG5vZGVqcywgdGhpbmsgYWJvdXQgYGZzLnJlYWRkaXJTeW5jYCxcbiAgICpcbiAgICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBwYXRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHJvb3RcbiAgICogQHJldHVybiB7QXJyYXl9IHRoZSByZXN1bHRcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG4gIGZpbmRbdHlwZSArICdTeW5jJ10gPSBmdW5jdGlvbihwYXQsIHJvb3QpIHtcbiAgICB2YXIgYnVmZmVyID0gW107XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xuICAgICAgcm9vdCA9IHBhdDtcbiAgICAgIHBhdCA9ICcnO1xuICAgIH1cbiAgICB0cmF2ZXJzZVN5bmMocm9vdCwgdHlwZSwgZnVuY3Rpb24obikge1xuICAgICAgYnVmZmVyLnB1c2gobik7XG4gICAgfSk7XG4gICAgcmV0dXJuIHBhdCAmJiBidWZmZXIuZmlsdGVyKGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiBjb21wYXJlKHBhdCwgbik7XG4gICAgfSkgfHwgYnVmZmVyO1xuICB9XG5cbn0pO1xuXG5cbnZhciBmc01ldGhvZHMgPSBbXG4gICdleGlzdHNTeW5jJyxcbiAgJ2xzdGF0U3luYycsXG4gICdyZWFscGF0aCcsXG4gICdyZWFscGF0aFN5bmMnLFxuICAncmVhZGRpcicsXG4gICdyZWFkZGlyU3luYydcbl07XG5cblxuLyoqXG4gKiBDb25maWd1YXRpb25zIGZvciBpbnRlcm5hbCB1c2FnZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gKiBAYXBpIHB1YmxpY1xuICovXG5maW5kLnVzZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5mcykge1xuICAgIGlmIChmc01ldGhvZHMuZXZlcnkobiA9PiAhIW9wdGlvbnMuZnNbbl0pKSB7XG4gICAgICBmcyA9IG9wdGlvbnMuZnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHByb3ZpZGVkIGZzIG9iamVjdCBpcyBub3QgY29tcGF0aWFibGUgd2l0aCBuYXRpdmUgZnMuJyk7XG4gICAgfVxuICB9XG4gIHJldHVybiBmaW5kO1xufVxuIiwiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIEZpbGVTeXN0ZW1BZGFwdGVyLCBQbHVnaW5NYW5pZmVzdCwgV29ya3NwYWNlLCBNYXJrZG93blZpZXcsIE9ic2lkaWFuUHJvdG9jb2xEYXRhIH0gZnJvbSAnb2JzaWRpYW4nXG5pbXBvcnQgeyBqb2luLCBkaXJuYW1lLCBzZXAgfSBmcm9tICdwYXRoJ1xuaW1wb3J0IHsgZGlyIH0gZnJvbSAnZmluZCdcbmltcG9ydCB7IHByb21pc2VzIH0gZnJvbSAnZnMnXG5cbmNvbnN0IGhhc2hSZWdleCA9ICAvIyhbYS16QS1aLV9dKz8pKDopKC0/W1xcZC5dKyg/OmUtP1xcZCspPyk/LztcbmNvbnN0IGFjdGlvbk5hbWUgPSAnb3Blbi10by1saW5lJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW1kb25lUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblxuXHR3b3Jrc3BhY2U6IFdvcmtzcGFjZTtcblx0YWRhcHRlcjogRmlsZVN5c3RlbUFkYXB0ZXI7XG5cdGltZG9uZVBhdGhzOiBzdHJpbmdbXTtcblx0aW5JbWRvbmVQcm9qZWN0OiBib29sZWFuO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW5NYW5pZmVzdDogUGx1Z2luTWFuaWZlc3QpIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbk1hbmlmZXN0KTtcblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLndvcmtzcGFjZSA9IGFwcC53b3Jrc3BhY2U7XG5cdFx0dGhpcy5hZGFwdGVyID0gYXBwLnZhdWx0LmFkYXB0ZXIgYXMgRmlsZVN5c3RlbUFkYXB0ZXI7XG5cdH1cblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0Y29uc29sZS5sb2coJ2xvYWRpbmcgaW1kb25lIHBsdWdpbicpO1xuXG5cdFx0dGhpcy5pbWRvbmVQYXRocyA9IGF3YWl0IHRoaXMuZ2V0SW1kb25lUHJvamVjdFBhdGhzKCk7XG5cdFx0dGhpcy5pbkltZG9uZVByb2plY3QgPSBhd2FpdCB0aGlzLmlzVmF1bHRJbkltZG9uZVByb2plY3QoKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHRoaXMubWFya2Rvd25Qb3N0UHJvY2Vzc29yKGVsLCBjdHgpKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJPYnNpZGlhblByb3RvY29sSGFuZGxlcihhY3Rpb25OYW1lLCAocGFyYW1zOiBPYnNpZGlhblByb3RvY29sRGF0YSkgPT4ge1xuXHRcdFx0aWYgKHBhcmFtcy5hY3Rpb24gPT0gYWN0aW9uTmFtZSAmJiBwYXJhbXMuZmlsZSkge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gcGFyYW1zLmZpbGUuc3Vic3RyaW5nKDEpLnJlcGxhY2UoL1xcXFwvZywgJy8nKVxuXHRcdFx0XHR0aGlzLndvcmtzcGFjZS5vcGVuTGlua1RleHQoZmlsZSwgJycsIGZhbHNlLCB7c3RhdGU6IHttb2RlOidzb3VyY2UnfX0pLnRoZW4oKCkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGNtRWRpdG9yID0gdGhpcy5nZXRFZGl0b3IoKTtcblx0XHRcdFx0XHRpZiAoIWNtRWRpdG9yKSByZXR1cm47XG5cdFx0XHRcdFx0aWYgKHBhcmFtcy5saW5lKSB7XG5cdFx0XHRcdFx0XHRjbUVkaXRvci5zZXRDdXJzb3IocGFyc2VJbnQocGFyYW1zLmxpbmUsIDEwKSwgMCk7XG5cdFx0XHRcdFx0XHRjbUVkaXRvci5zY3JvbGxJbnRvVmlldyhudWxsLCAyMDApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjbUVkaXRvci5mb2N1cygpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdGNvbnNvbGUubG9nKCd1bmxvYWRpbmcgaW1kb25lIHBsdWdpbicpO1xuXHR9XG5cblx0Z2V0RWRpdG9yKCkge1xuXHRcdGNvbnN0IG1hcmtkb3duVmlldyA9IHRoaXMud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRpZiAoIW1hcmtkb3duVmlldykgcmV0dXJuO1xuXHRcdGNvbnN0IGNtRWRpdG9yID0gbWFya2Rvd25WaWV3LnNvdXJjZU1vZGUuY21FZGl0b3I7XG5cdFx0cmV0dXJuIGNtRWRpdG9yO1xuXHR9XG5cblx0YXN5bmMgbWFya2Rvd25Qb3N0UHJvY2Vzc29yKGVsOiBIVE1MRWxlbWVudCwgY3R4OiBhbnkpIHtcblx0XHRjb25zdCBzb3VyY2VGaWxlUGF0aCA9IGpvaW4odGhpcy5nZXRWYXVsdFBhdGgoKSxjdHguc291cmNlUGF0aCk7XG5cdFx0aWYgKHRoaXMuaXNGaWxlSW5JbWRvbmVQcm9qZWN0KHNvdXJjZUZpbGVQYXRoKSkge1xuXHRcdFx0dGhpcy51cGRhdGVDYXJkTGlua3NIcmVmKGVsKTtcblx0XHRcdHRoaXMubWFrZUNhcmRIYXNodGFnc0xpbmtzKGVsKTtcblx0XHR9XG5cdH1cblxuXHRpc0ltZG9uZUNhcmRMaW5rKGVsOiBIVE1MQW5jaG9yRWxlbWVudCk6IEJvb2xlYW4ge1xuXHRcdHJldHVybiBlbCAmJiBoYXNoUmVnZXgudGVzdChlbC5oYXNoKTtcblx0fVxuXG5cdGdldEltZG9uZUNhcmRMaW5rcyhlbDogSFRNTEVsZW1lbnQpOiBBcnJheTxIVE1MQW5jaG9yRWxlbWVudD4ge1xuXHRcdGNvbnN0IGxpbmtzID0gQXJyYXkuZnJvbShlbC5xdWVyeVNlbGVjdG9yQWxsKCcuZXh0ZXJuYWwtbGluaycpKSBhcyBBcnJheTxIVE1MQW5jaG9yRWxlbWVudD47XG5cdFx0cmV0dXJuIGxpbmtzLmZpbHRlcihlbCA9PiB0aGlzLmlzSW1kb25lQ2FyZExpbmsoZWwpKTtcblx0fVxuXG5cdHVwZGF0ZUNhcmRMaW5rc0hyZWYoZWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgbGlua3MgPSB0aGlzLmdldEltZG9uZUNhcmRMaW5rcyhlbCk7XG5cdFx0bGlua3MuZm9yRWFjaCgobGluaykgPT4ge1xuXHRcdFx0Y29uc3QgeyB0ZXh0LCBoYXNoIH0gPSBsaW5rO1xuXHRcdFx0bGluay5ocmVmID0gdGhpcy5nZXRJbWRvbmVVUkwodGV4dCwgaGFzaCwgJ01BUktET1dOJyk7XG5cdFx0fSlcblx0fVxuXG5cdGlzSW1kb25lQ2FyZEhhc2h0YWcoZWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0cmV0dXJuIGhhc2hSZWdleC50ZXN0KGVsLnBhcmVudEVsZW1lbnQuZ2V0VGV4dCgpKTtcblx0fVxuXG5cdGdldEltZG9uZUNhcmRIYXNodGFncyhlbDogSFRNTEVsZW1lbnQpOiBBcnJheTxIVE1MQW5jaG9yRWxlbWVudD4ge1xuXHRcdGNvbnN0IGxpbmtzID0gQXJyYXkuZnJvbShlbC5xdWVyeVNlbGVjdG9yQWxsKCdhLnRhZ1tocmVmXj1cIiNcIl0nKSkgYXMgQXJyYXk8SFRNTEFuY2hvckVsZW1lbnQ+IFxuXHRcdHJldHVybiBsaW5rcy5maWx0ZXIoZWwgPT4gdGhpcy5pc0ltZG9uZUNhcmRIYXNodGFnKGVsKSlcblx0fVxuXG5cdG1ha2VDYXJkSGFzaHRhZ3NMaW5rcyhlbDogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmdldEltZG9uZUNhcmRIYXNodGFncyhlbCkuZm9yRWFjaChlbCA9PiB7XG5cdFx0XHRjb25zdCBwYXJlbnQgPSBlbC5wYXJlbnRFbGVtZW50O1xuXHRcdFx0Y29uc3QgdGFnID0gZWwuaW5uZXJUZXh0O1xuXHRcdFx0Y29uc3QgdGV4dCA9IHBhcmVudC5nZXRUZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNoID0gdGV4dC5tYXRjaChoYXNoUmVnZXgpWzBdO1xuXG5cdFx0XHRwYXJlbnQuY2hpbGROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuXHRcdFx0XHRpZiAobm9kZS5ub2RlTmFtZSA9PT0gJyN0ZXh0Jykgbm9kZS50ZXh0Q29udGVudCA9ICcnO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IGltZG9uZUxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdFx0XHRjb25zdCBpbWRvbmVMaW5rVGV4dCA9IHRleHQucmVwbGFjZShoYXNoLCAnJyk7XG5cdFx0XHRpbWRvbmVMaW5rLnNldFRleHQodGV4dC5yZXBsYWNlKHRhZywgJycpKTtcblx0XHRcdGltZG9uZUxpbmsuaHJlZiA9ICB0aGlzLmdldEltZG9uZVVSTChpbWRvbmVMaW5rVGV4dCwgaGFzaCwgJ0hBU0hUQUcnKTtcblx0XHRcdGltZG9uZUxpbmsuYWRkQ2xhc3MoJ2V4dGVybmFsLWxpbmsnKTtcblx0XHRcdHBhcmVudC5hcHBlbmQoaW1kb25lTGluayk7XG5cdFx0fSk7XG5cdH1cblxuXHRnZXRJbWRvbmVVUkwodGV4dDogc3RyaW5nLCBoYXNoOnN0cmluZyAsIHR5cGU6J01BUktET1dOJyB8ICdIQVNIVEFHJykge1xuXHRcdGNvbnN0IHBhdGggPSB0aGlzLmdldEFjdGl2ZUZpbGVQYXRoKCkucmVwbGFjZSgvXFxcXC9nLCAnLycpO1xuXHRcdHJldHVybiBgaW1kb25lOi8vJHtlbmNvZGVVUkkocGF0aCl9P3RleHQ9JHtlbmNvZGVVUklDb21wb25lbnQodGV4dC50cmltKCkpfSZoYXNoPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGhhc2gpfSZ0eXBlPSR7dHlwZX1gO1xuXHR9XG5cblx0Z2V0QWN0aXZlRmlsZVBhdGgoKSB7XG5cdFx0Y29uc3QgcGF0aCA9IHRoaXMud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKS5wYXRoO1xuXHRcdHJldHVybiB0aGlzLmFkYXB0ZXIuZ2V0RnVsbFBhdGgocGF0aCk7XG5cdH1cblxuXHRnZXRBY3RpdmVGaWxlRGlyKCkge1xuXHRcdHJldHVybiBqb2luKHRoaXMuZ2V0VmF1bHRQYXRoKCksIGRpcm5hbWUodGhpcy53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLnBhdGgpKTtcblx0fVxuXG5cdGdldFZhdWx0UGF0aCgpIHtcblx0XHRyZXR1cm4gdGhpcy5hZGFwdGVyLmdldEJhc2VQYXRoKCk7XG5cdH1cblxuXHRhc3luYyBpc1ZhdWx0SW5JbWRvbmVQcm9qZWN0KCkge1xuXHRcdGxldCBjd2QgPSB0aGlzLmdldFZhdWx0UGF0aCgpO1xuXHRcdHdoaWxlKHRydWUpIHtcblx0XHRcdGNvbnN0IGltZG9uZVBhdGggPSBqb2luKGN3ZCwgJy5pbWRvbmUnKTtcblx0XHRcdGlmIChhd2FpdCB0aGlzLmV4aXN0cyhpbWRvbmVQYXRoKSkgcmV0dXJuICEhaW1kb25lUGF0aDtcblx0XHRcdGNvbnN0IGRpck5hbWVzID0gY3dkLnNwbGl0KHNlcCk7XG5cdFx0XHRkaXJOYW1lcy5wb3AoKTtcblx0XHRcdGN3ZCA9IGRpck5hbWVzLmpvaW4oc2VwKTtcblx0XHRcdGlmIChjd2QgPT09ICcnKSByZXR1cm47XG5cdFx0fVxuXHR9XG5cblx0aXNGaWxlSW5JbWRvbmVQcm9qZWN0KGZpbGU6IHN0cmluZykge1xuXHRcdHJldHVybiB0aGlzLmluSW1kb25lUHJvamVjdCB8fCB0aGlzLmltZG9uZVBhdGhzLmZpbmQoX3BhdGggPT4ge1xuXHRcdFx0cmV0dXJuIGZpbGUuc3RhcnRzV2l0aChfcGF0aCk7XG5cdFx0fSk7XG5cdH1cblxuXHRhc3luYyBnZXRJbWRvbmVQcm9qZWN0UGF0aHMoKTpQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0Y29uc3QgY3dkID0gdGhpcy5nZXRWYXVsdFBhdGgoKTtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0ZGlyKC9cXC5pbWRvbmUkLywgY3dkLCBkaXJzID0+IHtcblx0XHRcdFx0cmVzb2x2ZShkaXJzLm1hcChkaXIgPT4gZGlyLnJlcGxhY2UoL1xcLmltZG9uZSQvLCAnJykpKTtcblx0XHRcdH0pLmVycm9yKHJlamVjdCk7XG5cdFx0fSk7XG5cdH1cblxuXHRhc3luYyBleGlzdHMoX3BhdGg6IHN0cmluZyk6UHJvbWlzZTxib29sZWFuPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHN0YXRzID0gYXdhaXQgcHJvbWlzZXMuc3RhdChfcGF0aCk7XG5cdFx0XHRyZXR1cm4gc3RhdHMgJiYgc3RhdHMuaXNEaXJlY3RvcnkoKTtcblx0XHR9IGNhdGNoIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cbn1cbiJdLCJuYW1lcyI6WyJyZXF1aXJlJCQwIiwicGF0aCIsIkNoYWluIiwiUGx1Z2luIiwiTWFya2Rvd25WaWV3Iiwiam9pbiIsImRpcm5hbWUiLCJzZXAiLCJkaXIiLCJwcm9taXNlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1REE7QUFDTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7QUFDN0QsSUFBSSxTQUFTLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxPQUFPLEtBQUssWUFBWSxDQUFDLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVUsT0FBTyxFQUFFLEVBQUUsT0FBTyxDQUFDLEtB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
